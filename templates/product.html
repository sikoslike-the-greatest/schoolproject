<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ product.product_name }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='product.css') }}">
</head>
<body>
    <header>
        <a href="/">Главная</a>
        <a href="/profile">Корзина</a>
    </header>
    <h1>{{ product.product_name }}</h1>
    <div class="product-images">
        <div class="slider">
            <div class="slider-container">
                {% for image in product.images %}
                    <img src="{{ image }}" alt="{{ product.product_name }}">
                {% endfor %}
            </div>
        </div>
        <button class="prev" onclick="moveSlider(-1)">&#10094;</button>
        <button class="next" onclick="moveSlider(1)">&#10095;</button>
    </div>
    <div class="product-price">
        <p>Price: {{ product.price }}</p>
        <button onclick="addToCart('{{ product.product_name }}')">Add to Cart</button>
    </div>
    <div class="product-properties">
        <ul>
            {% for key, value in product.properties.items() %}
                <li>
                    <button 
                        class="size-button {{ 'selected' if value == request.args.get('sku') else '' }}" 
                        onclick="redirectToSize('{{ value }}')">{{ key }}</button>
                </li>
            {% endfor %}
        </ul>
    </div>

    <script>
        let currentIndex = 0;
        let selectedSize = '{{ request.args.get("sku", "") }}';

        function moveSlider(direction) {
            const slider = document.querySelector('.slider-container');
            const images = slider.children;
            const totalImages = images.length;

            currentIndex += direction;

            if (currentIndex < 0) {
                currentIndex = totalImages - 1;
            } else if (currentIndex >= totalImages) {
                currentIndex = 0;
            }

            const offset = -currentIndex * 100;
            slider.style.transform = `translateX(${offset}%)`;
        }

        function addToCart(productName) {
            if (!selectedSize) {
                alert('Please select a size before adding to cart!');
                return;
            }
            alert(`Added ${productName} (Size: ${selectedSize}) to cart!`);
        }

        function redirectToSize(sku) {
            const url = new URL(window.location.href);
            url.searchParams.set('sku', sku);
            window.location.href = url.toString();
        }
    </script>
</body>
</html>
